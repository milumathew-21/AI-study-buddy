<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learning Dashboard - Progress Tracker</title>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;}
.dashboard-container{max-width:1200px;margin:0 auto;}
.header{text-align:center;color:white;margin-bottom:30px;}
.header h1{font-size:2.8rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
.header p{font-size:1.2rem;opacity:0.9;}
.nav-buttons{display:flex;gap:15px;justify-content:center;margin-bottom:30px;flex-wrap:wrap;}
.nav-btn{background:white;color:#667eea;padding:12px 30px;border:none;border-radius:10px;font-weight:bold;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 15px rgba(0,0,0,0.2);}
.nav-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.3);}
.nav-btn.active{background:#667eea;color:white;}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px;}
.stat-card{background:white;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);transition:transform 0.3s;}
.stat-card:hover{transform:translateY(-5px);}
.stat-card .icon{font-size:3rem;margin-bottom:10px;}
.stat-card .label{color:#666;font-size:0.9rem;margin-bottom:5px;}
.stat-card .value{font-size:2rem;font-weight:bold;color:#667eea;}
.stat-card .subtext{color:#999;font-size:0.85rem;margin-top:5px;}
.card{background:white;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-bottom:30px;}
.card h2{color:#667eea;margin-bottom:20px;font-size:1.8rem;display:flex;align-items:center;gap:10px;}
.badges-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:20px;}
.badge-item{text-align:center;padding:20px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);border-radius:12px;transition:all 0.3s;cursor:pointer;position:relative;}
.badge-item:hover{transform:scale(1.05);box-shadow:0 8px 20px rgba(0,0,0,0.2);}
.badge-item.unlocked{background:linear-gradient(135deg,#ffd89b 0%,#19547b 100%);color:white;}
.badge-item.unlocked .badge-icon{animation:bounce 1s infinite;}
@keyframes bounce{0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}
.badge-item .badge-icon{font-size:3.5rem;margin-bottom:10px;}
.badge-item .badge-name{font-weight:bold;font-size:0.95rem;}
.badge-item .badge-desc{font-size:0.75rem;margin-top:5px;opacity:0.8;}
.badge-item.locked{opacity:0.5;}
.badge-item.locked .badge-icon{filter:grayscale(100%);}
.progress-section{margin-top:30px;}
.progress-item{margin-bottom:25px;}
.progress-header{display:flex;justify-content:space-between;margin-bottom:8px;}
.progress-header span{font-weight:bold;color:#333;}
.progress-bar{width:100%;height:25px;background:#e0e0e0;border-radius:12px;overflow:hidden;position:relative;}
.progress-fill{height:100%;background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);transition:width 1s ease;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;color:white;font-size:0.85rem;font-weight:bold;}
.chart-container{background:white;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-bottom:30px;}
.activity-log{max-height:400px;overflow-y:auto;}
.activity-item{padding:15px;border-left:4px solid #667eea;background:#f9f9f9;margin-bottom:15px;border-radius:8px;transition:all 0.3s;}
.activity-item:hover{background:#f0f0f0;transform:translateX(5px);}
.activity-time{color:#999;font-size:0.85rem;margin-bottom:5px;}
.activity-desc{color:#333;font-weight:500;}
.activity-stats{color:#666;font-size:0.9rem;margin-top:5px;}
.streak-display{text-align:center;padding:30px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;border-radius:15px;margin-bottom:30px;}
.streak-number{font-size:4rem;font-weight:bold;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
.streak-label{font-size:1.2rem;margin-top:10px;}
.weekly-chart{display:flex;align-items:flex-end;justify-content:space-around;height:200px;gap:10px;padding:20px;background:#f9f9f9;border-radius:10px;}
.chart-bar{flex:1;background:linear-gradient(180deg,#667eea 0%,#764ba2 100%);border-radius:8px 8px 0 0;position:relative;min-height:20px;transition:all 0.3s;cursor:pointer;}
.chart-bar:hover{opacity:0.8;transform:translateY(-5px);}
.chart-bar-label{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%);font-size:0.8rem;color:#666;white-space:nowrap;}
.chart-bar-value{position:absolute;top:-25px;left:50%;transform:translateX(-50%);font-weight:bold;color:#667eea;font-size:0.9rem;}
.achievements-summary{display:flex;gap:20px;flex-wrap:wrap;margin-top:20px;}
.achievement-box{flex:1;min-width:200px;padding:20px;background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;text-align:center;}
.achievement-box .number{font-size:2.5rem;font-weight:bold;color:#333;}
.achievement-box .label{color:#666;margin-top:5px;font-size:0.95rem;}
@media (max-width:768px){
    .stats-grid{grid-template-columns:1fr;}
    .header h1{font-size:2rem;}
    .badges-grid{grid-template-columns:repeat(auto-fill,minmax(120px,1fr));}
}
</style>
</head>
<body>
<div class="dashboard-container">
    <div class="header">
        <h1>Learning Dashboard</h1>
        <p>Track your amazing study journey!</p>
    </div>

    <div class="nav-buttons">
        <button class="nav-btn active" onclick="window.location.reload()"> Dashboard</button>
        <button class="nav-btn" onclick="alert('Open your Study Mode page to start a session!')"> Study Mode</button>
        <button class="nav-btn" onclick="exportReport()"> Export Report</button>
        <button class="nav-btn" style="background:#ef4444;color:white;" onclick="clearData()"> Clear Data</button>
    </div>

    <div class="streak-display">
        <div class="streak-number" id="currentStreak">0</div>
        <div class="streak-label"> Day Study Streak</div>
        <p style="margin-top:10px;font-size:0.9rem;">Keep it up! You're doing great!</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="icon"></div>
            <div class="label">Total Study Time</div>
            <div class="value" id="totalTime">0h 0m</div>
            <div class="subtext">All time</div>
        </div>
        <div class="stat-card">
            <div class="icon"></div>
            <div class="label">Average Focus</div>
            <div class="value" id="avgFocus">0%</div>
            <div class="subtext">Last 7 sessions</div>
        </div>
        <div class="stat-card">
            <div class="icon"></div>
            <div class="label">Study Sessions</div>
            <div class="value" id="totalSessions">0</div>
            <div class="subtext">Completed</div>
        </div>
        <div class="stat-card">
            <div class="icon"></div>
            <div class="label">Badges Earned</div>
            <div class="value" id="badgesEarned">0</div>
            <div class="subtext">Out of 12</div>
        </div>
    </div>

    <div class="card">
        <h2> Achievement Badges</h2>
        <div class="badges-grid" id="badgesGrid">
            <!-- Badges will be populated here -->
        </div>
    </div>

    <div class="card">
        <h2> Weekly Study Progress</h2>
        <div class="weekly-chart" id="weeklyChart">
            <!-- Chart bars will be populated here -->
        </div>
    </div>

    <div class="card">
        <h2> Learning Progress</h2>
        <div class="progress-section">
            <div class="progress-item">
                <div class="progress-header">
                    <span>Focus Mastery</span>
                    <span id="focusMastery">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="focusFill" style="width:0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span>Consistency Score</span>
                    <span id="consistencyScore">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="consistencyFill" style="width:0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span>Time Management</span>
                    <span id="timeManagement">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="timeFill" style="width:0%">0%</div>
                </div>
            </div>
        </div>

        <div class="achievements-summary">
            <div class="achievement-box">
                <div class="number" id="bestStreak">0</div>
                <div class="label">Best Study Streak</div>
            </div>
            <div class="achievement-box">
                <div class="number" id="longestSession">0m</div>
                <div class="label">Longest Session</div>
            </div>
            <div class="achievement-box">
                <div class="number" id="gamesPlayed">0</div>
                <div class="label">Brain Games Played</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2> Recent Activity</h2>
        <div class="activity-log" id="activityLog">
            <!-- Activity items will be populated here -->
        </div>
    </div>
</div>

<script>
// Badge definitions
const badges = [
    {id:'first_session',name:'First Steps',desc:'Complete first study session',icon:'🎯',condition:(d)=>d.totalSessions>=1},
    {id:'early_bird',name:'Early Bird',desc:'Study before 9 AM',icon:'🌅',condition:(d)=>d.hasEarlySession},
    {id:'night_owl',name:'Night Owl',desc:'Study after 9 PM',icon:'🦉',condition:(d)=>d.hasLateSession},
    {id:'focused_mind',name:'Focused Mind',desc:'Maintain 90%+ focus',icon:'🧠',condition:(d)=>d.bestFocus>=90},
    {id:'streak_3',name:'3-Day Streak',desc:'Study 3 days in a row',icon:'🔥',condition:(d)=>d.currentStreak>=3},
    {id:'streak_7',name:'Week Warrior',desc:'Study 7 days in a row',icon:'⚡',condition:(d)=>d.currentStreak>=7},
    {id:'time_master',name:'Time Master',desc:'Study for 2+ hours total',icon:'⏰',condition:(d)=>d.totalMinutes>=120},
    {id:'game_lover',name:'Game Lover',desc:'Play 5 brain games',icon:'🎮',condition:(d)=>d.gamesPlayed>=5},
    {id:'break_master',name:'Break Master',desc:'Take 10 healthy breaks',icon:'☕',condition:(d)=>d.breaksOaken>=10},
    {id:'perfect_week',name:'Perfect Week',desc:'Study every day this week',icon:'💎',condition:(d)=>d.perfectWeek},
    {id:'marathon',name:'Marathon Runner',desc:'60+ min session',icon:'🏃',condition:(d)=>d.longestSession>=60},
    {id:'super_learner',name:'Super Learner',desc:'Complete 20 sessions',icon:'🌟',condition:(d)=>d.totalSessions>=20}
];

// Simulated data - in real app, this would be loaded from storage
let userData = {
    totalSessions: 0,
    totalMinutes: 0,
    currentStreak: 0,
    bestStreak: 0,
    longestSession: 0,
    avgFocus: 0,
    gamesPlayed: 0,
    breaksOaken: 0,
    bestFocus: 0,
    hasEarlySession: false,
    hasLateSession: false,
    perfectWeek: false,
    weeklyData: [0,0,0,0,0,0,0], // Last 7 days
    recentActivities: []
};

// Load data from localStorage or initialize empty
function loadUserData(){
    const saved = localStorage.getItem('studyDashboardData');
    if(saved){
        userData = JSON.parse(saved);
        console.log('✅ Loaded user data:', userData);
    }else{
        // Initialize with empty data - no demo
        userData = {
            totalSessions: 0,
            totalMinutes: 0,
            currentStreak: 0,
            bestStreak: 0,
            longestSession: 0,
            avgFocus: 0,
            gamesPlayed: 0,
            breaksOaken: 0,
            bestFocus: 0,
            hasEarlySession: false,
            hasLateSession: false,
            perfectWeek: false,
            weeklyData: [0,0,0,0,0,0,0],
            recentActivities: [],
            lastStudyDate: null
        };
        console.log('📝 Initialized empty dashboard - start studying to see your progress!');
    }
    updateDashboard();
}

function updateDashboard(){
    // Update stats
    const hours = Math.floor(userData.totalMinutes/60);
    const mins = userData.totalMinutes%60;
    document.getElementById('totalTime').textContent = `${hours}h ${mins}m`;
    document.getElementById('avgFocus').textContent = `${userData.avgFocus}%`;
    document.getElementById('totalSessions').textContent = userData.totalSessions;
    document.getElementById('currentStreak').textContent = userData.currentStreak;
    
    // Calculate unlocked badges
    const unlockedCount = badges.filter(b=>b.condition(userData)).length;
    document.getElementById('badgesEarned').textContent = `${unlockedCount}/12`;
    
    // Update progress bars
    const focusMastery = Math.min(100, (userData.avgFocus/100)*100);
    const consistency = Math.min(100, (userData.currentStreak/7)*100);
    const timeManage = Math.min(100, (userData.totalMinutes/600)*100);
    
    updateProgressBar('focusFill','focusMastery',focusMastery);
    updateProgressBar('consistencyFill','consistencyScore',consistency);
    updateProgressBar('timeFill','timeManagement',timeManage);
    
    // Update achievement boxes
    document.getElementById('bestStreak').textContent = userData.bestStreak;
    document.getElementById('longestSession').textContent = `${userData.longestSession}m`;
    document.getElementById('gamesPlayed').textContent = userData.gamesPlayed;
    
    // Populate badges
    populateBadges();
    
    // Populate weekly chart
    populateWeeklyChart();
    
    // Populate activity log
    populateActivityLog();
}

function updateProgressBar(fillId, textId, percentage){
    const fill = document.getElementById(fillId);
    const text = document.getElementById(textId);
    const rounded = Math.round(percentage);
    
    setTimeout(()=>{
        fill.style.width = `${rounded}%`;
        fill.textContent = `${rounded}%`;
        text.textContent = `${rounded}%`;
    },100);
}

function populateBadges(){
    const grid = document.getElementById('badgesGrid');
    grid.innerHTML = '';
    
    badges.forEach(badge=>{
        const unlocked = badge.condition(userData);
        const div = document.createElement('div');
        div.className = `badge-item ${unlocked?'unlocked':'locked'}`;
        div.innerHTML = `
            <div class="badge-icon">${badge.icon}</div>
            <div class="badge-name">${badge.name}</div>
            <div class="badge-desc">${badge.desc}</div>
        `;
        div.onclick = ()=>{
            alert(unlocked 
                ? `🎉 ${badge.name}\n\n${badge.desc}\n\n✓ Unlocked!`
                : `🔒 ${badge.name}\n\n${badge.desc}\n\n❌ Not unlocked yet. Keep studying!`
            );
        };
        grid.appendChild(div);
    });
}

function populateWeeklyChart(){
    const chart = document.getElementById('weeklyChart');
    chart.innerHTML = '';
    
    const days = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    const maxValue = Math.max(...userData.weeklyData, 1);
    
    userData.weeklyData.forEach((mins, idx)=>{
        const height = (mins/maxValue)*100;
        const bar = document.createElement('div');
        bar.className = 'chart-bar';
        bar.style.height = `${height}%`;
        bar.innerHTML = `
            <div class="chart-bar-value">${mins}m</div>
            <div class="chart-bar-label">${days[idx]}</div>
        `;
        bar.onclick = ()=>{
            alert(`${days[idx]}: ${mins} minutes studied`);
        };
        chart.appendChild(bar);
    });
}

function populateActivityLog(){
    const log = document.getElementById('activityLog');
    log.innerHTML = '';
    
    if(userData.recentActivities.length === 0){
        log.innerHTML = '<p style="text-align:center;color:#999;padding:20px;">No recent activity yet. Start studying to see your progress!</p>';
        return;
    }
    
    userData.recentActivities.forEach(activity=>{
        const div = document.createElement('div');
        div.className = 'activity-item';
        div.innerHTML = `
            <div class="activity-time">${activity.date}</div>
            <div class="activity-desc">${activity.desc}</div>
            ${activity.focus ? `<div class="activity-stats">Focus Score: ${activity.focus}%</div>` : ''}
        `;
        log.appendChild(div);
    });
}

function goToStudyMode(){
    alert('Redirecting to Study Mode... (In real app, this would navigate to the study page)');
    // window.location.href = 'study-mode.html';
}

function clearData(){
    if(confirm('⚠️ Are you sure you want to clear all progress data?\n\nThis will delete:\n- All study sessions\n- Badges earned\n- Activity history\n- Statistics\n\nThis action cannot be undone!')){
        localStorage.removeItem('studyDashboardData');
        alert('✅ All data cleared! Refresh the page to see empty dashboard.');
        window.location.reload();
    }
}

function exportReport(){
    const report = `
📊 LEARNING PROGRESS REPORT
========================

👤 Student Performance Summary
Generated: ${new Date().toLocaleString()}

📈 STATISTICS
-------------
Total Study Time: ${Math.floor(userData.totalMinutes/60)}h ${userData.totalMinutes%60}m
Total Sessions: ${userData.totalSessions}
Average Focus: ${userData.avgFocus}%
Current Streak: ${userData.currentStreak} days
Best Streak: ${userData.bestStreak} days
Longest Session: ${userData.longestSession} minutes

🏆 ACHIEVEMENTS
--------------
Badges Earned: ${badges.filter(b=>b.condition(userData)).length}/12
Brain Games Played: ${userData.gamesPlayed}
Healthy Breaks Taken: ${userData.breaksOaken}

📊 PROGRESS SCORES
-----------------
Focus Mastery: ${Math.round((userData.avgFocus/100)*100)}%
Consistency: ${Math.round((userData.currentStreak/7)*100)}%
Time Management: ${Math.round((userData.totalMinutes/600)*100)}%

Keep up the great work! 🌟
    `;
    
    const blob = new Blob([report], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `learning-report-${new Date().toISOString().split('T')[0]}.txt`;
    a.click();
    URL.revokeObjectURL(url);
}

// Add function to save session data from study mode
function saveSessionData(sessionData){
    userData.totalSessions++;
    userData.totalMinutes += sessionData.minutes;
    userData.longestSession = Math.max(userData.longestSession, sessionData.minutes);
    userData.avgFocus = Math.round((userData.avgFocus * (userData.totalSessions-1) + sessionData.focus) / userData.totalSessions);
    userData.bestFocus = Math.max(userData.bestFocus, sessionData.focus);
    userData.gamesPlayed += sessionData.gamesPlayed || 0;
    userData.breaksOaken += sessionData.breaks || 0;
    
    // Update weekly data (current day)
    const today = new Date().getDay();
    const dayIndex = today === 0 ? 6 : today - 1; // Convert Sunday=0 to Monday=0
    userData.weeklyData[dayIndex] += sessionData.minutes;
    
    // Add to recent activities
    userData.recentActivities.unshift({
        date: new Date().toLocaleString(),
        desc: `Completed ${sessionData.minutes}-min study session`,
        focus: sessionData.focus
    });
    
    if(userData.recentActivities.length > 10){
        userData.recentActivities = userData.recentActivities.slice(0,10);
    }
    
    localStorage.setItem('studyDashboardData', JSON.stringify(userData));
}

// Initialize dashboard
loadUserData();

// Make saveSessionData globally available
window.saveSessionData = saveSessionData;
</script>
</body>
</html>
