<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learning Dashboard - Progress Tracker</title>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;}
.dashboard-container{max-width:1200px;margin:0 auto;}
.header{text-align:center;color:white;margin-bottom:30px;}
.header h1{font-size:2.8rem;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
.header p{font-size:1.2rem;opacity:0.9;}
.nav-buttons{display:flex;gap:15px;justify-content:center;margin-bottom:30px;flex-wrap:wrap;}
.nav-btn{background:white;color:#667eea;padding:12px 30px;border:none;border-radius:10px;font-weight:bold;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 15px rgba(0,0,0,0.2);}
.nav-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.3);}
.nav-btn.active{background:#667eea;color:white;}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px;}
.stat-card{background:white;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);transition:transform 0.3s;}
.stat-card:hover{transform:translateY(-5px);}
.stat-card .icon{font-size:3rem;margin-bottom:10px;}
.stat-card .label{color:#666;font-size:0.9rem;margin-bottom:5px;}
.stat-card .value{font-size:2rem;font-weight:bold;color:#667eea;}
.stat-card .subtext{color:#999;font-size:0.85rem;margin-top:5px;}
.card{background:white;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-bottom:30px;}
.card h2{color:#667eea;margin-bottom:20px;font-size:1.8rem;display:flex;align-items:center;gap:10px;}
.badges-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:20px;}
.badge-item{text-align:center;padding:20px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);border-radius:12px;transition:all 0.3s;cursor:pointer;position:relative;}
.badge-item:hover{transform:scale(1.05);box-shadow:0 8px 20px rgba(0,0,0,0.2);}
.badge-item.unlocked{background:linear-gradient(135deg,#ffd89b 0%,#19547b 100%);color:white;}
.badge-item.unlocked .badge-icon{animation:bounce 1s infinite;}
@keyframes bounce{0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}
.badge-item .badge-icon{font-size:3.5rem;margin-bottom:10px;}
.badge-item .badge-name{font-weight:bold;font-size:0.95rem;}
.badge-item .badge-desc{font-size:0.75rem;margin-top:5px;opacity:0.8;}
.badge-item.locked{opacity:0.5;}
.badge-item.locked .badge-icon{filter:grayscale(100%);}
.progress-section{margin-top:30px;}
.progress-item{margin-bottom:25px;}
.progress-header{display:flex;justify-content:space-between;margin-bottom:8px;}
.progress-header span{font-weight:bold;color:#333;}
.progress-bar{width:100%;height:25px;background:#e0e0e0;border-radius:12px;overflow:hidden;position:relative;}
.progress-fill{height:100%;background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);transition:width 1s ease;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;color:white;font-size:0.85rem;font-weight:bold;}
.chart-container{background:white;padding:25px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-bottom:30px;}
.activity-log{max-height:400px;overflow-y:auto;}
.activity-item{padding:15px;border-left:4px solid #667eea;background:#f9f9f9;margin-bottom:15px;border-radius:8px;transition:all 0.3s;}
.activity-item:hover{background:#f0f0f0;transform:translateX(5px);}
.activity-time{color:#999;font-size:0.85rem;margin-bottom:5px;}
.activity-desc{color:#333;font-weight:500;}
.activity-stats{color:#666;font-size:0.9rem;margin-top:5px;}
.streak-display{text-align:center;padding:30px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;border-radius:15px;margin-bottom:30px;}
.streak-number{font-size:4rem;font-weight:bold;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
.streak-label{font-size:1.2rem;margin-top:10px;}
.weekly-chart{display:flex;align-items:flex-end;justify-content:space-around;height:200px;gap:10px;padding:20px;background:#f9f9f9;border-radius:10px;}
.chart-bar{flex:1;background:linear-gradient(180deg,#667eea 0%,#764ba2 100%);border-radius:8px 8px 0 0;position:relative;min-height:20px;transition:all 0.3s;cursor:pointer;}
.chart-bar:hover{opacity:0.8;transform:translateY(-5px);}
.chart-bar-label{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%);font-size:0.8rem;color:#666;white-space:nowrap;}
.chart-bar-value{position:absolute;top:-25px;left:50%;transform:translateX(-50%);font-weight:bold;color:#667eea;font-size:0.9rem;}
.achievements-summary{display:flex;gap:20px;flex-wrap:wrap;margin-top:20px;}
.achievement-box{flex:1;min-width:200px;padding:20px;background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:12px;text-align:center;}
.achievement-box .number{font-size:2.5rem;font-weight:bold;color:#333;}
.achievement-box .label{color:#666;margin-top:5px;font-size:0.95rem;}
@media (max-width:768px){
    .stats-grid{grid-template-columns:1fr;}
    .header h1{font-size:2rem;}
    .badges-grid{grid-template-columns:repeat(auto-fill,minmax(120px,1fr));}
}
</style>
</head>
<body>
<div class="dashboard-container">
    <div class="header">
        <h1>üìä Learning Dashboard</h1>
        <p>Track your amazing study journey!</p>
    </div>

    <div class="nav-buttons">
        <button class="nav-btn active" onclick="window.location.reload()">üìä Dashboard</button>
        <button class="nav-btn" onclick="window.location.href='live3.html'">üìö Study Mode</button>
        <button class="nav-btn" onclick="exportReport()">üì• Export Report</button>
        <button class="nav-btn" style="background:#ef4444;color:white;" onclick="clearData()">üóëÔ∏è Clear Data</button>
    </div>

    <div class="streak-display">
        <div class="streak-number" id="currentStreak">0</div>
        <div class="streak-label">üî• Day Study Streak</div>
        <p style="margin-top:10px;font-size:0.9rem;">Keep it up! You're doing great!</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="icon">‚è±Ô∏è</div>
            <div class="label">Total Study Time</div>
            <div class="value" id="totalTime">0h 0m</div>
            <div class="subtext">All time</div>
        </div>
        <div class="stat-card">
            <div class="icon">üéØ</div>
            <div class="label">Average Focus</div>
            <div class="value" id="avgFocus">0%</div>
            <div class="subtext">Last 7 sessions</div>
        </div>
        <div class="stat-card">
            <div class="icon">üìñ</div>
            <div class="label">Study Sessions</div>
            <div class="value" id="totalSessions">0</div>
            <div class="subtext">Completed</div>
        </div>
        <div class="stat-card">
            <div class="icon">üèÜ</div>
            <div class="label">Badges Earned</div>
            <div class="value" id="badgesEarned">0/12</div>
            <div class="subtext">Out of 12</div>
        </div>
    </div>

    <div class="card">
        <h2>üèÖ Achievement Badges</h2>
        <div class="badges-grid" id="badgesGrid"></div>
    </div>

    <div class="card">
        <h2>üìà Weekly Study Progress</h2>
        <div class="weekly-chart" id="weeklyChart"></div>
    </div>

    <div class="card">
        <h2>üéì Learning Progress</h2>
        <div class="progress-section">
            <div class="progress-item">
                <div class="progress-header">
                    <span>Focus Mastery</span>
                    <span id="focusMastery">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="focusFill" style="width:0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span>Consistency Score</span>
                    <span id="consistencyScore">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="consistencyFill" style="width:0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-header">
                    <span>Time Management</span>
                    <span id="timeManagement">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="timeFill" style="width:0%">0%</div>
                </div>
            </div>
        </div>

        <div class="achievements-summary">
            <div class="achievement-box">
                <div class="number" id="bestStreak">0</div>
                <div class="label">Best Study Streak</div>
            </div>
            <div class="achievement-box">
                <div class="number" id="longestSession">0m</div>
                <div class="label">Longest Session</div>
            </div>
            <div class="achievement-box">
                <div class="number" id="gamesPlayed">0</div>
                <div class="label">Brain Games Played</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>üìù Recent Activity</h2>
        <div class="activity-log" id="activityLog"></div>
    </div>
</div>

<script>
// Badges definitions
const badges = [
{id:'first_session',name:'First Steps',desc:'Complete first study session',icon:'üéØ',condition:(s)=>s.length>=1},
{id:'streak_3',name:'3-Day Streak',desc:'Study 3 days in a row',icon:'üî•',condition:(s)=>calcStreak(s)>=3},
{id:'streak_7',name:'Week Warrior',desc:'Study 7 days in a row',icon:'‚ö°',condition:(s)=>calcStreak(s)>=7},
{id:'time_master',name:'Time Master',desc:'Study for 2+ hours total',icon:'‚è∞',condition:(s)=>s.reduce((a,b)=>a+b.minutes,0)>=120},
{id:'super_learner',name:'Super Learner',desc:'Complete 20 sessions',icon:'üåü',condition:(s)=>s.length>=20}
];

// Load sessions
let sessions = JSON.parse(localStorage.getItem('studySessions') || '[]');

// Utility to calculate current streak
function calcStreak(s){
    if(!s.length) return 0;
    s.sort((a,b)=>b.timestamp-a.timestamp);
    let streak=1;
    let prev = new Date(s[0].timestamp);
    for(let i=1;i<s.length;i++){
        const d = new Date(s[i].timestamp);
        if((prev-d)/(1000*60*60*24)<=1) streak++;
        else break;
        prev=d;
    }
    return streak;
}

// Update dashboard
function updateDashboard(){
    const totalMinutes = sessions.reduce((a,b)=>a+b.minutes,0);
    const avgFocus = sessions.length ? Math.round(sessions.reduce((a,b)=>a+b.focus,0)/sessions.length):0;
    const currentStreak = calcStreak(sessions);
    const bestStreak = currentStreak; // simple version, can calculate max streak

    document.getElementById('totalTime').textContent = `${Math.floor(totalMinutes/60)}h ${totalMinutes%60}m`;
    document.getElementById('avgFocus').textContent = `${avgFocus}%`;
    document.getElementById('totalSessions').textContent = sessions.length;
    document.getElementById('currentStreak').textContent = currentStreak;
    document.getElementById('bestStreak').textContent = bestStreak;
    document.getElementById('longestSession').textContent = sessions.length ? `${Math.max(...sessions.map(s=>s.minutes))}m`:'0m';
    document.getElementById('gamesPlayed').textContent = sessions.reduce((a,b)=>a+b.gamesPlayed,0);

    // Progress bars
    updateProgress('focusFill','focusMastery',avgFocus);
    updateProgress('consistencyFill','consistencyScore',Math.min(100,(currentStreak/7)*100));
    updateProgress('timeFill','timeManagement',Math.min(100,(totalMinutes/600)*100));

    // Badges
    const grid = document.getElementById('badgesGrid');
    grid.innerHTML='';
    badges.forEach(b=>{
        const unlocked = b.condition(sessions);
        const div = document.createElement('div');
        div.className = `badge-item ${unlocked?'unlocked':'locked'}`;
        div.innerHTML=`<div class="badge-icon">${b.icon}</div><div class="badge-name">${b.name}</div><div class="badge-desc">${b.desc}</div>`;
        div.onclick=()=>alert(`${b.name}\n${b.desc}`);
        grid.appendChild(div);
    });
    document.getElementById('badgesEarned').textContent = badges.filter(b=>b.condition(sessions)).length + '/'+badges.length;

    // Weekly chart (Mon-Sun)
    const weekMinutes = [0,0,0,0,0,0,0]; // Mon-Sun
    const now = new Date();
    sessions.forEach(s=>{
        const d = new Date(s.timestamp);
        const diff = (now - d)/(1000*60*60*24);
        if(diff<=7){
            const day = d.getDay(); // 0-Sun
            weekMinutes[(day+6)%7]+=s.minutes; // shift so Mon=0
        }
    });
    const chart = document.getElementById('weeklyChart');
    chart.innerHTML='';
    ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'].forEach((day,i)=>{
        const bar = document.createElement('div');
        bar.className='chart-bar';
        bar.style.height = `${Math.min(weekMinutes[i]*2,150)}px`;
        bar.innerHTML=`<div class="chart-bar-label">${day}</div><div class="chart-bar-value">${weekMinutes[i]}m</div>`;
        chart.appendChild(bar);
    });

    // Activity log
    const log = document.getElementById('activityLog');
    log.innerHTML='';
    if(!sessions.length) log.innerHTML='<p style="text-align:center;color:#999;padding:20px;">No recent activity yet. Start studying to see your progress!</p>';
    else sessions.slice().reverse().forEach(s=>{
        const div = document.createElement('div');
        div.className='activity-item';
        div.innerHTML=`<div class="activity-time">${new Date(s.timestamp).toLocaleString()}</div>
        <div class="activity-desc">Completed ${s.minutes}-min study session</div>
        <div class="activity-stats">Focus: ${s.focus}%, Breaks: ${s.breaks}</div>`;
        log.appendChild(div);
    });
}

// Update progress bar helper
function updateProgress(fillId,labelId,value){
    document.getElementById(fillId).style.width = value+'%';
    document.getElementById(fillId).textContent = value+'%';
    document.getElementById(labelId).textContent = value+'%';
}

// Clear all data
function clearData(){
    if(confirm('Are you sure you want to clear all study data?')){localStorage.removeItem('studySessions');sessions=[];updateDashboard();}
}

// Export report
function exportReport(){
    const data = JSON.stringify(sessions,null,2);
    const blob = new Blob([data],{type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href=url;
    a.download='study_report.json';
    a.click();
    URL.revokeObjectURL(url);
}

// Initialize
updateDashboard();
</script>
</body>
</html>
